# 嵌入式编程

## DSP
&emsp;DSP（digital singnal processor）是一种独特的微处理器，有自己的完整指令系统，是以数字信号来处理大量信息的器件。它是集成专用计算机的一种芯片，只有一枚硬币那么大。 <br>
&emsp;DSP芯片，由于它运算能力很强，速度很快，体积很小，而且采用软件编程具有高度的灵活性，因此为从事各种复杂的应用提供了一条有效途径。其主要应用是实时快速地实现各种数字信号处理算法。根据数字信号处理的要求，DSP芯片一般具有如下主要特点:
* （1）在一个指令周期内可完成一次乘法和一次加法；
* （2）程序和数据空间分开，可以同时访问指令和数据；
* （3）片内具有快速RAM，通常可通过独立的数据总线在两块中同时访问；
* （4）具有低开销或无开销循环及跳转的硬件支持；
* （5）快速的中断处理和硬件I/O支持；
* （6）具有在单周期内操作的多个硬件地址产生器；
* （7）可以并行执行多个操作；
* （8）支持流水线操作，使取指、译码和执行等操作可以重叠执行。

&emsp;**性能**。DSP现今最快的主频能达到1.2Ghz。当然不能单纯从主频判断它的性能会比ARM差，DSP具有单时钟周期内完成一次乘法和一次加法的能力，一般的ARM不具备这样的能力，DSP在计算领域优势尤其明显，所以TI结合了ARM和DSP两者的优势，生产出达芬奇异构芯片，当然这是属于SOC的范畴了。 <br>

&emsp;**功耗**。DSP相对于FPGA的一个优势就是它的功耗相对较低，DSP生产厂商通过提高处理器的主频、努力降低功耗来保证它的市场占有率，这也是能与FPGA在数字信号处理各得半壁江山的主要原因。因为在高性能的数字信号处理市场上，FPGA更占优势。 <br>

&emsp;**应用**。DSP主要针对一些计算能力要求较高的应用，如视频图像处理、智能机器人、数字无线、宽带访问、数字音频、高分辨率成像和数字电机控制等。

&emsp;**开发成本**。DSP入门较容易，但单芯片成本较高，主要还是应用于对计算能力要求高的应用。当然DSP也可以搭载操作系统，搭载操作系统后可适用于多任务的应用上。

## FPGA
&emsp;FPGA(Field－Programmable Gate Array)，即现场可编程门阵列，它是在PAL、GAL、CPLD等可编程器件的基础上进一步发展的产物。它是作为专用集成电路(ASIC)领域中的一种半定制电路而出现的，既解决了定制电路的不足，又克服了原有可编程器件门电路数有限的缺点。 <br>

&emsp;**结构**。FPGA采用了逻辑单元阵列LCA（LogicCellArray）这样一个新概念，内部包括可配置逻辑模块CLB（ConfigurableLogicBlock）、输出输入模块IOB（InputOutputBlock）和内部连线（Interconnect）三个部分。用户可对FPGA内部的逻辑模块和I/O模块重新配置，以实现用户的逻辑。它还具有静态可重复编程和动态在系统重构的特性，使得硬件的功能可以像软件一样通过编程来修改。<br>

&emsp;**功耗**。FPGA由于它的内部结构原因造成它的功耗相对较高、芯片发热量大，这也是它的一个缺点。但这也是不可避免的，在支持高性能的并发计算数字电路，且内部的逻辑门大都采用标准的宽长比，最终生成的数字电路必然会在功耗上无法与ASIC等专用处理器比较。 <br>

&emsp;**性能**。FPGA主频时钟最高可达几Ghz甚至上10Ghz，当然它的成本也不菲。如果将FPGA与ARM、DSP等作为比较，从主频上进行比较是没有多大意义的，毕竟并行计算的能力要远远超出一般通用的处理器采用的串行计算几十倍。如同样的一个滤波算法在主频为100Mhz的FPGA上实现要比在主频为1Ghz的ARM上实现仍要快。 <br>

&emsp;**开发成本**。FPGA的开发难度较大并且开发周期也相对较长，此外它的单芯片成本很高。

## MCU
&emsp;MCU本质为一片单片机，指将计算机的CPU、RAM、ROM、定时计数器和多种I/O接口集成在一片芯片上，形成的芯片级的计算机。指令集上早期的MCU是采用CISC的，后面被RISC取代。在总线位数上，MCU覆盖了4位、8位、16位、32位，应用十分广泛。 <br>
**冯诺衣曼结构** 基本部分：
* 一个中央处理器核心
* 程序员存储器(只读存储器或者闪存)
* 数据存储器（随机存储器)
* 一个或者更多的定时/计数器
* 与外围设备以及扩展资源进行通信的输入/输出端口

&emsp;**应用**。MCU应用最为广泛，主要利益于它的成本控制上，使它能在许多对计算能力要求不那么高的应用立足。相信在未来几年里，MCU市场关键增长驱动力将来自于绿色能源，智能电子设备，智能电网以及电子产品的升级换代比如汽车电子。

&emsp;**开发成本**。MCU入门最容易，上手也快，开发难度较小，并且它的成本低，在低端市场应用最为广泛。<br>

## ARM
&emsp;ARM (Advanced RISC Machines) 处理器是Acorn计算机有限公司面向低预算市场设计的第一款RISC微处理器。RISC的全称是"精简指令集计算机"（reduced instruction set computer)。ARM可以理解为一个公司的名字也可以认为是对一类微处理器的统称，还可以认为是一种技术 (ARM技术知识产品(IP)核)。 <br>

&emsp;**ARM多采用流水线技术，此技术通过多个功率部件并行工作来缩短程序执行时间，使指令能在多条流水线上流动，从而提高处理器的效率和吞吐率**。现今ARM7采用了典型的三级流水线，ARM9采用五级流水线技术，而ARM11使用了7级流水线，ARMCortex-A9更是使用了可变流水线结构（支持8-11级流水线）。在多核心的支持上ARMCortex-A9最多可支持4个核心，这是ARM系列处理器中首次支持多核心技术。下图表示了ARMCortex-A9的内部结构。 <br>

&emsp;**功耗**。ARM最大的优势在于速度快、**低功耗**、芯片集成度高，多数ARM芯片都可以算作SOC，基本上外围加上电源和驱动接口就可以做成一个小系统了。基于ARM核心处理器的嵌入式系统以其自身资源丰富、功耗低、价格低廉、支持厂商众多的缘故，越来越多地应用在各种需要复杂控制和通信功能的嵌入式系统中。 <br>

&emsp;**应用**。ARM处理器现在主要是三个系列分别为A系列、R系列、M系列。
* A系列。主要应用于电子应用：
  * 计算：上网本、智能本、输入板、电子书阅读器、瘦客户端
  * 手机：智能手机、特色手机
  * 数字家电：机顶盒、数字电视、蓝光播放器、游戏控制台
  * 汽车：信息娱乐、导航
  * 企业：激光打印机、路由器、无线基站、VOIP电话和设备
  * 无线基础结构：Web2.0、无线基站、交换机、服务器
* R系列处理器。主要针对一些对实时性要求较高的应用，如航空航天、汽车电子等场合，它具备高可靠性、高可用性、高容错能力、实时响应等优点。
* M系列处理器。主要针对较低端的应用，它的最初目标是替换现有的市面上的MCU。

&emsp;**开发成本**。ARM主要是搭载LINUX、ANDROID、WINCE等操作系统，在开发难度上看，相对MCU、DSP较难入门，它需要开发人员对操作系统有较深的了解；从成本来看，ARM的单芯片成本较MCU要高，主要还是应用于一些较为复杂的系统上。<br>








---
## ARM和DSP比较
### .1 主要区别
* ARM具有比较强的事务管理功能，主要体现在控制方面，它的速度和数据处理能力一般，但是外围接口比较丰富，标准化和通用性比较好，功耗控制得很好，所以适合用在一些消费电子产品上。
* DSP主要是用来计算的，比如进行加密解密、调制解调等，优势是强大的数据处理能力和较高的运行速度。它可以在一个指令周期中同时完成一次乘法和一次加法，这非常适合快速傅立叶变换的需求。DSP有专门的指令集,主要是专门针对通讯和多媒体处理的。
### .2 详细区别
* 密集乘法支持。通用处理器GPP不是设计来做密集乘法任务的，及时一些现代的GPP也要求多个指令来做一次乘法。DSP使用专门的硬件来实现单周期乘法，几乎所有的DSP指令集都包含显式的MAC指令。
* 存储器结构。
  * GPP使用**冯.诺依曼存储器结构**。(ARM9开始就使用了哈佛结构)这种结构中，只有一个存储器空间通过一组总线（一个地址总线和一个数据总线）连接到处理器核。通常，做一次乘法会发生4次存储器访问，用掉至少四个指令周期。
  * 大多数DSP采用了**哈佛结构**，将存储器空间划分成两个，分别存储程序和数据。它们有两组总线连接到处理器核，允许同时对它们进行访问。这种安排将处理器存贮器的带宽加倍，更重要的是同时为处理器核提供数据与指令。在这种布局下，DSP得以实现单周期的MAC指令。
  * GPP使用控制逻辑来决定哪些数据和指令字存储在片内的高速缓存里，其程序员并不加以指定（也可能根本不知道）。与此相反，DSP使用多个片内存储器和多组总线来保证每个指令周期内存储器的多次访问。在使用DSP时，程序员要明确地控制哪些数据和指令要存储在片内存储器中（CMD文件的编写）。程序员在写程序时，必须保证处理器能够有效地使用其双总线。
  * 此外，DSP处理器几乎都不具备数据高速缓存。这是因为DSP的典型数据是数据流。也就是说，DSP处理器对每个数据样本做计算后，就丢弃了，几乎不再重复使用。
* 零开销循环。
  * 大多数的DSP都有专门的硬件，用于零开销循环。所谓零开销循环是指处理器在执行循环时，不用花时间去检查循环计数器的值、条件转移到循环的顶部、将循环计数器减1（逆序加减指令）。
* 定点计算。
  * 大多数DSP使用定点计算，而不是使用浮点。虽然DSP的应用必须十分注意数字的精确，用浮点来做应该容易的多，但是对DSP来说，廉价也是非常重要的。定点机器比起相应的浮点机器来要便宜（而且更快）。为了不使用浮点机器而又保证数字的准确，DSP处理器在指令集和硬件方面都支持饱和计算、舍入和移位。
